


<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>  Spark(Pyspark) |    white.</title>
  <meta name="description" content="A minimalist theme for hexo.">
  <!-- 标签页图标 -->
  

  <!-- 图标库 -->
  <link href="https://cdn.jsdelivr.net/npm/remixicon@2.2.0/fonts/remixicon.css" rel="stylesheet">
  <!-- 动画库 -->
  
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fushaolei/cdn-white@1.0/css/animate.css"/>
  
  <!-- css文件 -->
  
<link rel="stylesheet" href="/css/white.css">

  <!-- 代码高亮 -->
  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>

<div class="menu-outer">
    <div class="menu-inner">
      <div class="menu-site-name  animate__animated  animate__fadeInUp">
        <a href="/">
          white.
        </a>
        
      </div>
      <div class="menu-group">
        <ul class="menu-ul">
        
          <a href="/" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              HOME
            </li>
          </a>
        
          <a href="/archives" class="nav-link">
            <li class="menu-li  animate__animated  animate__fadeInUp">
              BLOG
            </li>
          </a>
        
        
        
          <li class="menu-li animate__animated  animate__fadeInUp" id="mobile-menu">
            <i class="ri-menu-line"></i>
          </li>
        
        </ul>

      </div>

    </div>
</div>
<div id="mobile-main" class="animate__animated  animate__fadeIn">
  <div class="mobile-menu-inner">
    <div class="mobile-menu-site-name animate__animated  animate__fadeInUp">
      <a href="/">
        white.
      </a>
    </div>
    <div class="mobile-menu-group" id="mobile-close">
      <i class="ri-close-line"></i>
    </div>

  </div>

  <div class="mobile-menu-div">
  
    <a href="/" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>HOME</span>
      </div>
    </a>
  
    <a href="/archives" class="mobile-nav-link">
      <div class="mobile-menu-child animate__animated  animate__fadeInUp">
        <span>BLOG</span>
      </div>
    </a>
  
  
  </div>


</div>

<div class="body-outer">
  <div class="body-inner">
    
<article class="post-inner">
  <div class="post-content-outer">
    <div class="post-intro">
      <div class="post-title animate__animated  animate__fadeInUp">Spark(Pyspark)</div>
      <div class="meta-intro animate__animated  animate__fadeInUp">Jun 14 2023</div>
      
    </div>
    <div class="post-content-inner">
      <div class="post-content-inner-space">

      </div>
      <div class="post-content-main animate__animated  animate__fadeInUp">
        <!-- top型目录 -->
        
        <h1 id="1、Pyspark环境配置安装"><a href="#1、Pyspark环境配置安装" class="headerlink" title="1、Pyspark环境配置安装"></a>1、Pyspark环境配置安装</h1><p>PySpark是Spark官方提供的一个Python类库，内置了Spark API，可以通过PySpark类库来编写Spark程序，并提交到Spark集群中运行。</p>
<p>准备工作：</p>
<p>（1）将课程资料中提供的的hadoop-3.3.0文件，复制到某个盘符下（中文的且无空格的）。</p>
<p>（2）将文件夹内bin内的Hadoop.dll复制到C:\Windows\Systmctl32里面去。</p>
<p>（3）在系统环境变量中配置HADOOP_HOME，指向hadoop-3.3.0文件夹的路径。</p>
<p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/1.png" >
        </sapn>
      </p>
<h1 id="2、本机PySpark环境配置"><a href="#2、本机PySpark环境配置" class="headerlink" title="2、本机PySpark环境配置"></a>2、本机PySpark环境配置</h1><p>在前面部署Spark的时候，已经在Linux系统上部署了acaconda的Python环境，故本次在Windows上安装anaconda，并配置PySpark库。</p>
<h2 id="2-1-在课程资料中选择anaconda应用程序双击安装"><a href="#2-1-在课程资料中选择anaconda应用程序双击安装" class="headerlink" title="2.1.在课程资料中选择anaconda应用程序双击安装"></a>2.1.在课程资料中选择anaconda应用程序双击安装</h2><p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/2.png" >
        </sapn>
      </p>
<h2 id="2-2-一直选择Next，进行安装"><a href="#2-2-一直选择Next，进行安装" class="headerlink" title="2.2.一直选择Next，进行安装"></a>2.2.一直选择Next，进行安装</h2><p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/3.png" >
        </sapn>
      </p>
<p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/4.png" >
        </sapn>
      </p>
<h2 id="2-3-安装结束后会出现anaconda3文件夹。打开Anaconda-Prompt-anaconda-会出现base，即为安装成功。"><a href="#2-3-安装结束后会出现anaconda3文件夹。打开Anaconda-Prompt-anaconda-会出现base，即为安装成功。" class="headerlink" title="2.3.安装结束后会出现anaconda3文件夹。打开Anaconda Prompt(anaconda),会出现base，即为安装成功。"></a>2.3.安装结束后会出现anaconda3文件夹。打开Anaconda Prompt(anaconda),会出现base，即为安装成功。</h2><p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/5.png" >
        </sapn>
      </p>
<p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/6.png" >
        </sapn>
      </p>
<h1 id="3、配置国内源，加速网络下载"><a href="#3、配置国内源，加速网络下载" class="headerlink" title="3、配置国内源，加速网络下载"></a>3、配置国内源，加速网络下载</h1><p>在Anaconda Prompt(anaconda)中执行conda config –set show_channel<br>_urls yes。<br>将如下内容替换到C:\Users\用户名.condarc文件中。</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">channels:</span><br><span class="line">- defaults</span><br><span class="line">show_channel_urls: true</span><br><span class="line">default_channels:</span><br><span class="line">- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main</span><br><span class="line">- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/r</span><br><span class="line">- https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/msys2</span><br><span class="line">custom_channels:</span><br><span class="line">conda-forge: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">msys2: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">bioconda: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">menpo: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">pytorch: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br><span class="line">simpleitk: https://mirrors.tuna.tsinghua.edu.cn/anaconda/cloud</span><br></pre></td></tr></table></figure>

<p>创建虚拟环境</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">创建虚拟环境 pyspark, 基于Python 3.8</span><br><span class="line">conda create -n pyspark python=3.8</span><br><span class="line">切换到虚拟环境内</span><br><span class="line">conda activate pyspark</span><br><span class="line">在虚拟环境内安装包</span><br><span class="line">pip install pyhive pyspark jieba -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>
        <span class="lazyload-img-span">
        <img   
           data-src="/../image/pyspark/7.png" >
        </sapn>
      </p>

        <!-- 分类文章 -->
        
      </div>
      <div class="post-content-inner-space">
        
          <div class="space-toc-main animate__animated  animate__fadeInUp">
            <ol class="space-toc"><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#2-1-%E5%9C%A8%E8%AF%BE%E7%A8%8B%E8%B5%84%E6%96%99%E4%B8%AD%E9%80%89%E6%8B%A9anaconda%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E5%8F%8C%E5%87%BB%E5%AE%89%E8%A3%85"><span class="space-toc-text">2.1.在课程资料中选择anaconda应用程序双击安装</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#2-2-%E4%B8%80%E7%9B%B4%E9%80%89%E6%8B%A9Next%EF%BC%8C%E8%BF%9B%E8%A1%8C%E5%AE%89%E8%A3%85"><span class="space-toc-text">2.2.一直选择Next，进行安装</span></a></li><li class="space-toc-item space-toc-level-2"><a class="space-toc-link" href="#2-3-%E5%AE%89%E8%A3%85%E7%BB%93%E6%9D%9F%E5%90%8E%E4%BC%9A%E5%87%BA%E7%8E%B0anaconda3%E6%96%87%E4%BB%B6%E5%A4%B9%E3%80%82%E6%89%93%E5%BC%80Anaconda-Prompt-anaconda-%E4%BC%9A%E5%87%BA%E7%8E%B0base%EF%BC%8C%E5%8D%B3%E4%B8%BA%E5%AE%89%E8%A3%85%E6%88%90%E5%8A%9F%E3%80%82"><span class="space-toc-text">2.3.安装结束后会出现anaconda3文件夹。打开Anaconda Prompt(anaconda),会出现base，即为安装成功。</span></a></li></ol>
           </div>
        
      </div>
   </div>
    <!-- 评论 -->
    
  </div>
</article>
  </div>
</div>



<!-- 如果是home模式的话，不在首页就显示footer，如果不是home模式的话 所有都显示footer -->

  <div class="footer-outer animate__animated  animate__fadeInUp">
    <div class="footer-inner">
    <div class="footer-text">
    <p>Power by <a target="_blank" rel="noopener" href="http://hexo.io/">Hexo</a> Theme by <a target="_blank" rel="noopener" href="https://github.com/FuShaoLei/hexo-theme-white">White</a></p>

    </div>
    <div class="footer-contact">
    <ul class="footer-ul">
        
        <li class="footer-li">
            <a href="https://github.com/FuShaoLei/hexo-theme-white" target="_blank">
                <i class="ri-github-line"></i>
            </a>
        </li>
        
        <li class="footer-li">
            <a href="mailto:1563250958@qq.com" target="_blank">
                <i class="ri-mail-line"></i>
            </a>
        </li>
        
    </ul>
    </div>
    </div>
</div>






<script src="/js/white.js"></script>



</body>
</html>
